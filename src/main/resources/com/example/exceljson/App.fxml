<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.Insets?>
<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>
<?import javafx.scene.image.Image?>
<?import javafx.scene.image.ImageView?>

<BorderPane xmlns="http://javafx.com/javafx/8" xmlns:fx="http://javafx.com/fxml/1"
            fx:controller="com.example.exceljson.AppController"
            styleClass="border-pane">
    <!-- Top App Bar -->
    <top>
        <HBox alignment="CENTER_LEFT" spacing="10" styleClass="app-bar">
            <!-- Left: App Title and Version -->
            <VBox spacing="2" alignment="CENTER_LEFT">
                <Label text="Engage FlowForge" style="-fx-font-size:18; -fx-font-weight:bold; -fx-text-fill:white;" />
                <Label text="Version 3.1" style="-fx-font-size:10; -fx-text-fill:rgba(255,255,255,0.8);" />
            </VBox>
            
            <Separator orientation="VERTICAL" />
            
            <!-- Center: Status Indicators -->
            <VBox spacing="3" alignment="CENTER_LEFT" HBox.hgrow="ALWAYS">
                <Label fx:id="statusLabel" text="Ready" style="-fx-text-fill:white; -fx-font-weight:bold;" />
                <ProgressBar fx:id="statusProgressBar" prefWidth="300" prefHeight="8" visible="false" managed="false" 
                    style="-fx-accent: #4CAF50; -fx-background-color: rgba(255,255,255,0.2); -fx-background-radius: 4;" />
                <HBox spacing="8" alignment="CENTER_LEFT">
                    <Label fx:id="currentFileLabel" text="No file loaded" style="-fx-text-fill:rgba(255,255,255,0.8); -fx-font-size:11;" />
                    <Label fx:id="jsonModeLabel" text="JSON: Standard" style="-fx-text-fill:rgba(255,255,255,0.8); -fx-font-size:11;" />
                </HBox>
            </VBox>
            
            <Separator orientation="VERTICAL" />
            
            <!-- Profile Switcher -->
            <VBox spacing="3" alignment="CENTER">
                <Label text="Profile:" style="-fx-text-fill:rgba(255,255,255,0.8); -fx-font-size:10;" />
                <ToggleButton fx:id="profileSwitcher" text="IE" styleClass="app-bar-button" selected="true">
                    <tooltip>
                        <Tooltip text="Switch between IE (Implementation Engineer) and CI (Clinical Informatics) profiles" />
                    </tooltip>
                </ToggleButton>
            </VBox>
            
            <!-- Right: Global Actions -->
            <HBox spacing="6" alignment="CENTER_RIGHT">
                <Button fx:id="settingsButton" text="‚öôÔ∏è Settings" styleClass="app-bar-button">
                    <tooltip>
                        <Tooltip text="Open Settings" />
                    </tooltip>
                </Button>
                <Button fx:id="saveExcelButton" text="üíæ Save" disable="true" styleClass="app-bar-button">
                    <tooltip>
                        <Tooltip text="Save Changes to Excel" />
                    </tooltip>
                </Button>
                <Button fx:id="themeToggleButton" text="üåì Toggle" styleClass="app-bar-button">
                    <tooltip>
                        <Tooltip text="Switch between light and dark themes" />
                    </tooltip>
                </Button>
                <Button fx:id="helpButton" text="‚ùì Help" styleClass="app-bar-button">
                    <tooltip>
                        <Tooltip text="Help and About" />
                    </tooltip>
                </Button>
            </HBox>
        </HBox>
    </top>

    
    <!-- Main Content Area with Side Navigation -->
    <center>
        <BorderPane>
            <!-- Left: Side Navigation Panel -->
            <left>
                <BorderPane fx:id="sidebarContainer" prefWidth="193" minWidth="46">
                    <top>
                        <!-- Branding Bar with Icon and Toggle -->
                        <VBox spacing="0" styleClass="sidebar-header">
                            <!-- App Icon and Brand -->
                            <HBox alignment="CENTER" spacing="8" style="-fx-padding: 10 8; -fx-background-color: #00979D;">
                                <ImageView fx:id="sidebarLogoImage" fitHeight="28" fitWidth="28" preserveRatio="true">
                                    <image>
                                        <Image url="@/icon_32.png" />
                                    </image>
                                </ImageView>
                                <VBox fx:id="sidebarBrandText" spacing="0" alignment="CENTER_LEFT" HBox.hgrow="ALWAYS">
                                    <Label text="FlowForge" style="-fx-text-fill: white; -fx-font-size: 13px; -fx-font-weight: bold;" />
                                    <Label text="v3.1" style="-fx-text-fill: rgba(255,255,255,0.7); -fx-font-size: 9px;" />
                                </VBox>
                            </HBox>
                            <!-- Collapse/Expand Toggle Button -->
                            <Button fx:id="sidebarToggleButton" text="‚óÄ" maxWidth="Infinity" 
                                    styleClass="sidebar-toggle-btn" onAction="#toggleSidebar">
                                <tooltip>
                                    <Tooltip text="Collapse/Expand Sidebar" />
                                </tooltip>
                            </Button>
                        </VBox>
                    </top>
                    <center>
                        <VBox fx:id="sidebarContent" spacing="3" styleClass="side-nav" style="-fx-background-color: #B8C4CE; -fx-padding: 4; -fx-spacing: 3;">
                            <!-- Load Section -->
                            <VBox spacing="2" styleClass="sidebar-section">
                                <Label fx:id="loadDataLabel" text="üìÇ LOAD DATA" styleClass="sidebar-section-header" />
                                <VBox fx:id="loadButtonsContainer" spacing="2">
                                <!-- Load NDW (Excel) -->
                                <Button fx:id="loadNdwButton" text="üìÑ NDW File" maxWidth="Infinity" styleClass="nav-button">
                                    <userData>üìÑ</userData>
                                    <tooltip>
                                        <Tooltip text="Load NDW Excel workbook (*.xlsx)" />
                                    </tooltip>
                                </Button>
                                <!-- Load Engage XML -->
                                <Button fx:id="loadXmlButton" text="üìã Engage XML" maxWidth="Infinity" styleClass="nav-button">
                                    <userData>üìã</userData>
                                    <tooltip>
                                        <Tooltip text="Load Engage interface rules from XML (*.xml)" />
                                    </tooltip>
                                </Button>
                                <!-- Load Engage Rules (JSON) -->
                                <Button fx:id="loadJsonButton" text="üì• Engage JSON" maxWidth="Infinity" styleClass="nav-button">
                                    <userData>üì•</userData>
                                    <tooltip>
                                        <Tooltip text="Load previously exported Engage Rules JSON (*.json)" />
                                    </tooltip>
                                    </Button>
                                </VBox>
                            </VBox>
                            
                            <!-- Save to NDW (CI Mode Only) -->
                                <Button fx:id="saveOnNdwButton" text="üíæ Save to NDW" disable="true" maxWidth="Infinity" styleClass="nav-button" visible="false" managed="false">
                                <userData>üíæ</userData>
                                <tooltip>
                                    <Tooltip text="Save changes back to the NDW Excel file" />
                                </tooltip>
                                </Button>
                            
                            <!-- Navigation Section -->
                            <VBox spacing="2" styleClass="sidebar-section">
                                <Label text="üìë VIEWS" styleClass="sidebar-section-header" />
                                    
                                    <!-- Units Navigation -->
                                    <ToggleButton fx:id="navUnits" text="üìä Units" maxWidth="Infinity" styleClass="nav-button" selected="true" style="-fx-font-weight: bold;">
                                <userData>üìä</userData>
                                <toggleGroup>
                                    <ToggleGroup fx:id="navigationGroup" />
                                </toggleGroup>
                            </ToggleButton>
                            
                            <!-- Nurse Calls Navigation -->
                            <ToggleButton fx:id="navNurseCalls" text="üîî Nurse Calls" maxWidth="Infinity" styleClass="nav-button" toggleGroup="$navigationGroup" style="-fx-font-weight: bold;">
                                <userData>üîî</userData>
                            </ToggleButton>
                            
                            <!-- Clinicals Navigation -->
                            <ToggleButton fx:id="navClinicals" text="üè• Clinicals" maxWidth="Infinity" styleClass="nav-button" toggleGroup="$navigationGroup" style="-fx-font-weight: bold;">
                                <userData>üè•</userData>
                            </ToggleButton>
                            
                            <!-- Orders Navigation -->
                            <ToggleButton fx:id="navOrders" text="üíä Orders" maxWidth="Infinity" styleClass="nav-button" toggleGroup="$navigationGroup" style="-fx-font-weight: bold;">
                                <userData>üíä</userData>
                                </ToggleButton>
                            </VBox>
                            
                            <!-- Actions Section -->
                            <VBox spacing="2" styleClass="sidebar-section">
                                <Label text="‚ö° ACTIONS" styleClass="sidebar-section-header" />
                                
                                <!-- View JSON -->
                                <Button fx:id="generateJsonButton" text="üëÅÔ∏è View JSON" maxWidth="Infinity" styleClass="side-nav-action">
                                <userData>üëÅÔ∏è</userData>
                                <tooltip>
                                    <Tooltip text="View JSON file for all selected rows in the dataset" />
                                </tooltip>
                                </Button>
                            </VBox>
                            
                            <!-- Export JSON Section -->
                            <VBox spacing="2" styleClass="sidebar-section">
                                <Label fx:id="exportJsonLabel" text="üì§ EXPORT" styleClass="sidebar-section-header" />
                                <VBox fx:id="exportButtonsContainer" spacing="2">
                                <!-- Export Nursecall JSON -->
                                <Button fx:id="exportNurseJsonButton" text="ü©∫ Nursecall" maxWidth="Infinity" styleClass="side-nav-action">
                                    <userData>ü©∫</userData>
                                    <tooltip>
                                        <Tooltip text="Export Nursecall JSON" />
                                    </tooltip>
                                </Button>
                                
                                <!-- Export Clinical JSON -->
                                <Button fx:id="exportClinicalJsonButton" text="üß¨ Clinicals" maxWidth="Infinity" styleClass="side-nav-action">
                                    <userData>üß¨</userData>
                                    <tooltip>
                                        <Tooltip text="Export Clinicals JSON" />
                                    </tooltip>
                                </Button>
                                
                                <!-- Export Orders JSON -->
                                <Button fx:id="exportOrdersJsonButton" text="üì¶ Orders" maxWidth="Infinity" styleClass="side-nav-action">
                                    <userData>üì¶</userData>
                                    <tooltip>
                                        <Tooltip text="Export Orders JSON" />
                                    </tooltip>
                                    </Button>
                                </VBox>
                            </VBox>
                            
                            <!-- Tools Section -->
                            <VBox spacing="2" styleClass="sidebar-section">
                                <Label text="üõ†Ô∏è TOOLS" styleClass="sidebar-section-header" />
                                    
                                    <!-- Visual Flow (renamed from Visual CallFlow) -->
                                    <Button fx:id="visualFlowButton" text="üîÄ Visual Flow" maxWidth="Infinity" styleClass="side-nav-action">
                                <userData>üîÄ</userData>
                                <tooltip>
                                    <Tooltip text="Generate Visual Flow Diagram" />
                                </tooltip>
                                    </Button>
                                    
                                    <!-- Reset Data -->
                                    <Button fx:id="clearAllButton" text="üîÑ Reset Data" disable="true" maxWidth="Infinity" styleClass="side-nav-action-warning">
                                <userData>üîÑ</userData>
                                <tooltip>
                                    <Tooltip text="Clear all loaded data and reset the application" />
                                </tooltip>
                                </Button>
                            </VBox>
                        </VBox>
                    </center>
                </BorderPane>
            </left>
            
            <!-- Center: Main Content with Settings Drawer and Data View -->
            <center>
                <BorderPane>
                    <!-- Settings Drawer (Collapsible) -->
                    <top>
                        <VBox fx:id="settingsDrawer" managed="false" visible="false" spacing="0" styleClass="settings-drawer">
                            <!-- Fixed Header -->
                            <HBox spacing="10" alignment="CENTER_LEFT" style="-fx-padding: 10;">
                                <Label text="‚öôÔ∏è SETTINGS" style="-fx-font-size:14; -fx-font-weight:bold;" />
                                <Region HBox.hgrow="ALWAYS" />
                                <Button fx:id="closeSettingsButton" text="‚úï" styleClass="close-button" />
                            </HBox>
                            
                            <Separator />
                            
                            <!-- Scrollable Content -->
                            <ScrollPane fitToWidth="true" hbarPolicy="NEVER" vbarPolicy="AS_NEEDED" 
                                        style="-fx-background-color: transparent; -fx-background: transparent;"
                                        VBox.vgrow="ALWAYS">
                                <VBox spacing="8" style="-fx-padding: 12;">
                                    <!-- Merge Engage Rules Options (Mutually Exclusive) -->
                                    <Label text="Merge Engage Rules" style="-fx-font-weight:bold;">
                                        <tooltip>
                                            <Tooltip text="Choose how to merge flows with identical delivery parameters. Only one option can be selected at a time." />
                                        </tooltip>
                                    </Label>
                                    
                                    <CheckBox fx:id="noMergeCheckbox" text="Standard (No Merge)">
                                        <tooltip>
                                            <Tooltip text="Standard Mode: Each alarm/alert gets its own separate delivery flow. This is the default behavior and creates the most granular output." />
                                        </tooltip>
                                    </CheckBox>
                                    
                                    <CheckBox fx:id="mergeByConfigGroupCheckbox" text="Merge Multiple Config Groups">
                                        <tooltip>
                                            <Tooltip text="Merge Multiple Config Groups: Combines flows with identical Priority, Device, Ringtone, Recipients, and Timing across MULTIPLE Config Groups. All involved Config Group names are listed in the flow name. Flows with different No Caregiver Groups will remain separate." />
                                        </tooltip>
                                    </CheckBox>
                                    
                                    <CheckBox fx:id="mergeAcrossConfigGroupCheckbox" text="Merge by Single Config Group" selected="true">
                                        <tooltip>
                                            <Tooltip text="Merge by Single Config Group: Combines flows with identical Priority, Device, Ringtone, Recipients, and Timing ONLY within the same Config Group. Flows in different Config Groups will remain separate, even if their delivery parameters match." />
                                        </tooltip>
                                    </CheckBox>
                                    
                                    <Separator />

                                    <!-- Data Validation Section -->
                                    <Label text="Data Validation" style="-fx-font-weight:bold;" />
                                    
                                    <!-- Voice Group Validation -->
                                    <Label text="Voice Group Validation" style="-fx-font-size: 11; -fx-text-fill: #888;" />
                                    <HBox spacing="10">
                                        <Button fx:id="loadVoiceGroupButton" text="Load Voice Group" styleClass="button-secondary" userData="üë•">
                                            <tooltip>
                                                <Tooltip text="Load valid voice groups from Excel/CSV (Column A or 'Group Name' column)" />
                                            </tooltip>
                                        </Button>
                                        <Button fx:id="clearVoiceGroupButton" text="Clear Loaded Groups" styleClass="button-secondary" userData="üóëÔ∏è">
                                            <tooltip>
                                                <Tooltip text="Clear loaded voice groups and reset validation" />
                                            </tooltip>
                                        </Button>
                                    </HBox>
                                    <Label fx:id="voiceGroupStatsLabel" text="No groups loaded" style="-fx-font-size: 10; -fx-text-fill: #666;" />
                                    
                                    <!-- Assignment Roles Validation -->
                                    <Label text="Assignment Roles Validation" style="-fx-font-size: 11; -fx-text-fill: #888;" />
                                    <HBox spacing="10">
                                        <Button fx:id="loadAssignmentRolesButton" text="Load AssignmentRoles" styleClass="button-secondary" userData="üé≠">
                                            <tooltip>
                                                <Tooltip text="Load valid assignment roles from Excel/CSV ('Name' column)" />
                                            </tooltip>
                                        </Button>
                                        <Button fx:id="clearAssignmentRolesButton" text="Clear Loaded Roles" styleClass="button-secondary" userData="üóëÔ∏è">
                                            <tooltip>
                                                <Tooltip text="Clear loaded assignment roles and reset validation" />
                                            </tooltip>
                                        </Button>
                                    </HBox>
                                    <Label fx:id="assignmentRolesStatsLabel" text="No roles loaded" style="-fx-font-size: 10; -fx-text-fill: #666;" />
                                    
                                    <!-- Bed List Validation -->
                                    <Label text="Bed List Validation" style="-fx-font-size: 11; -fx-text-fill: #888;" />
                                    <HBox spacing="10">
                                        <Button fx:id="loadBedListButton" text="Load Bed List" styleClass="button-secondary" userData="üõèÔ∏è">
                                            <tooltip>
                                                <Tooltip text="Load valid bed list from Excel/CSV ('Department' or 'Unit' column)" />
                                            </tooltip>
                                        </Button>
                                        <Button fx:id="clearBedListButton" text="Clear Loaded Beds" styleClass="button-secondary" userData="üóëÔ∏è">
                                            <tooltip>
                                                <Tooltip text="Clear loaded bed list and reset validation" />
                                            </tooltip>
                                        </Button>
                                    </HBox>
                                    <Label fx:id="bedListStatsLabel" text="No bed list loaded" style="-fx-font-size: 10; -fx-text-fill: #666;" />

                                    <Separator />
                                    
                                    <!-- Combine Config Group Toggle -->
                                    <HBox spacing="10" alignment="CENTER_LEFT">
                                        <Label text="Combine Config Group" style="-fx-font-weight:bold;" />
                                        <CheckBox fx:id="combineConfigGroupCheckbox">
                                            <tooltip>
                                                <Tooltip text="When enabled, rows with identical columns (except Config Group) will be merged into one, with unique Config Group values combined. Toggle off to revert the merge." />
                                            </tooltip>
                                        </CheckBox>
                                    </HBox>
                                    
                                    <Separator />
                                    
                                    <!-- Custom Tab Mappings (MOVED UP) -->
                                    <Label text="Custom Tab Mappings" style="-fx-font-weight:bold;">
                                        <tooltip>
                                            <Tooltip text="Map custom Excel tab names to flow types (case-insensitive)" />
                                        </tooltip>
                                    </Label>
                                    <GridPane hgap="8" vgap="6">
                                        <Label text="Custom Tab Name:" GridPane.columnIndex="0" GridPane.rowIndex="0" />
                                        <TextField fx:id="customTabNameField" promptText="e.g., IV Pump" prefWidth="150" GridPane.columnIndex="1" GridPane.rowIndex="0">
                                            <tooltip>
                                                <Tooltip text="Enter the exact name of a custom Excel tab (case-insensitive)" />
                                            </tooltip>
                                        </TextField>
                                        
                                        <Label text="Maps To:" GridPane.columnIndex="0" GridPane.rowIndex="1" />
                                        <ComboBox fx:id="customTabFlowTypeCombo" prefWidth="150" GridPane.columnIndex="1" GridPane.rowIndex="1">
                                            <tooltip>
                                                <Tooltip text="Select which flow type this custom tab should map to" />
                                            </tooltip>
                                        </ComboBox>
                                        
                                        <Button fx:id="addCustomTabButton" text="Add Mapping" GridPane.columnIndex="1" GridPane.rowIndex="2" styleClass="button-secondary" />
                                    </GridPane>
                                    
                                    <Label text="Current Mappings:" style="-fx-font-size: 11; -fx-text-fill: gray;" />
                                    <ListView fx:id="customTabMappingsList" prefHeight="60" styleClass="custom-tab-list">
                                        <tooltip>
                                            <Tooltip text="Current custom tab mappings. Double-click to remove." />
                                        </tooltip>
                                    </ListView>
                                    
                                    <!-- Custom Tab Statistics -->
                                    <Label fx:id="customTabStatsLabel" text="" style="-fx-font-size: 10; -fx-text-fill: #666;" wrapText="true">
                                        <tooltip>
                                            <Tooltip text="Statistics about custom tabs processed from Excel" />
                                        </tooltip>
                                    </Label>
                                    
                                    <Separator />
                                    
                                    <!-- Adapter References, Vocera Badges Alert Interface, and Room Filters (Side by Side) -->
                                    <HBox spacing="20" alignment="TOP_LEFT">
                                        <!-- Left: Adapter References -->
                                        <VBox spacing="6">
                                            <Label text="Adapter Reference Names" style="-fx-font-weight:bold;" />
                                            <GridPane hgap="8" vgap="6">
                                                <Label text="Edge:" GridPane.columnIndex="0" GridPane.rowIndex="0" />
                                                <TextField fx:id="edgeRefNameField" promptText="OutgoingWCTP" prefWidth="150" GridPane.columnIndex="1" GridPane.rowIndex="0" />
                                                
                                                <Label text="VMP:" GridPane.columnIndex="0" GridPane.rowIndex="1" />
                                                <TextField fx:id="vcsRefNameField" promptText="VMP" prefWidth="150" GridPane.columnIndex="1" GridPane.rowIndex="1" />
                                                
                                                <Label text="Vocera:" GridPane.columnIndex="0" GridPane.rowIndex="2" />
                                                <TextField fx:id="voceraRefNameField" promptText="Vocera" prefWidth="150" GridPane.columnIndex="1" GridPane.rowIndex="2" />
                                                
                                                <Label text="XMPP:" GridPane.columnIndex="0" GridPane.rowIndex="3" />
                                                <TextField fx:id="xmppRefNameField" promptText="XMPP" prefWidth="150" GridPane.columnIndex="1" GridPane.rowIndex="3" />
                                            </GridPane>
                                            <Button fx:id="resetDefaultsButton" text="Reset to Defaults" styleClass="button-secondary" />
                                        </VBox>
                                        
                                        <!-- Center: Vocera Badges Alert Interface -->
                                        <VBox spacing="6">
                                            <Label text="Vocera Badges Alert Interface" style="-fx-font-weight:bold;" />
                                            <VBox spacing="4">
                                                <CheckBox fx:id="defaultEdgeCheckbox" text="Via Edge">
                                                    <tooltip>
                                                        <Tooltip text="Use OutgoingWCTP interface as default when Device A/B are blank" />
                                                    </tooltip>
                                                </CheckBox>
                                                <CheckBox fx:id="defaultVmpCheckbox" text="Via VMP">
                                                    <tooltip>
                                                        <Tooltip text="Use VMP interface as default when Device A/B are blank" />
                                                    </tooltip>
                                                </CheckBox>
                                                <CheckBox fx:id="defaultVoceraCheckbox" text="Via Vocera">
                                                    <tooltip>
                                                        <Tooltip text="Use Vocera interface as default when Device A/B are blank" />
                                                    </tooltip>
                                                </CheckBox>
                                                <CheckBox fx:id="defaultXmppCheckbox" text="Via XMPP">
                                                    <tooltip>
                                                        <Tooltip text="Use XMPP interface as default when Device A/B are blank" />
                                                    </tooltip>
                                                </CheckBox>
                                            </VBox>
                                        </VBox>
                                        
                                        <!-- Right: Room Filters -->
                                        <VBox spacing="6">
                                            <Label text="Room Filters" style="-fx-font-weight:bold;" />
                                            <GridPane hgap="8" vgap="6">
                                                <Label text="Nursecall:" GridPane.columnIndex="0" GridPane.rowIndex="0" />
                                                <TextField fx:id="roomFilterNursecallField" promptText="Room number" prefWidth="150" GridPane.columnIndex="1" GridPane.rowIndex="0">
                                                    <tooltip>
                                                        <Tooltip text="Filter Nursecall flows by room number" />
                                                    </tooltip>
                                                </TextField>
                                                
                                                <Label text="Clinical:" GridPane.columnIndex="0" GridPane.rowIndex="1" />
                                                <TextField fx:id="roomFilterClinicalField" promptText="Room number" prefWidth="150" GridPane.columnIndex="1" GridPane.rowIndex="1">
                                                    <tooltip>
                                                        <Tooltip text="Filter Clinical flows by room number" />
                                                    </tooltip>
                                                </TextField>
                                                
                                                <Label text="Orders:" GridPane.columnIndex="0" GridPane.rowIndex="2" />
                                                <TextField fx:id="roomFilterOrdersField" promptText="Room number" prefWidth="150" GridPane.columnIndex="1" GridPane.rowIndex="2">
                                                    <tooltip>
                                                        <Tooltip text="Filter Orders flows by room number" />
                                                    </tooltip>
                                                </TextField>
                                            </GridPane>
                                        </VBox>
                                    </HBox>
                                    
                                    <Separator />
                                    
                                    <!-- Row Height Controls -->
                                    <Label text="Table Row Height" style="-fx-font-weight:bold;" />
                                    
                                    <!-- Units Table Row Height -->
                                    <Label text="Units Table" style="-fx-font-size: 11; -fx-text-fill: #888;" />
                                    <HBox spacing="10" alignment="CENTER_LEFT">
                                        <Label text="Row Height:" style="-fx-font-size: 10;" />
                                        <Slider fx:id="unitsRowHeightSlider" min="24" max="150" value="72" blockIncrement="6" showTickLabels="false" showTickMarks="true" majorTickUnit="24" minorTickCount="5" prefWidth="150" />
                                        <Label fx:id="unitsRowHeightLabel" text="72 px" style="-fx-font-size: 10; -fx-min-width: 50;" />
                                    </HBox>
                                    
                                    <!-- Nurse Calls Table Row Height -->
                                    <Label text="Nurse Calls Table" style="-fx-font-size: 11; -fx-text-fill: #888;" />
                                    <HBox spacing="10" alignment="CENTER_LEFT">
                                        <Label text="Row Height:" style="-fx-font-size: 10;" />
                                        <Slider fx:id="nurseCallsRowHeightSlider" min="24" max="150" value="72" blockIncrement="6" showTickLabels="false" showTickMarks="true" majorTickUnit="24" minorTickCount="5" prefWidth="150" />
                                        <Label fx:id="nurseCallsRowHeightLabel" text="72 px" style="-fx-font-size: 10; -fx-min-width: 50;" />
                                    </HBox>
                                    
                                    <!-- Clinicals Table Row Height -->
                                    <Label text="Clinicals Table" style="-fx-font-size: 11; -fx-text-fill: #888;" />
                                    <HBox spacing="10" alignment="CENTER_LEFT">
                                        <Label text="Row Height:" style="-fx-font-size: 10;" />
                                        <Slider fx:id="clinicalsRowHeightSlider" min="24" max="150" value="72" blockIncrement="6" showTickLabels="false" showTickMarks="true" majorTickUnit="24" minorTickCount="5" prefWidth="150" />
                                        <Label fx:id="clinicalsRowHeightLabel" text="72 px" style="-fx-font-size: 10; -fx-min-width: 50;" />
                                    </HBox>
                                    
                                    <!-- Orders Table Row Height -->
                                    <Label text="Orders Table" style="-fx-font-size: 11; -fx-text-fill: #888;" />
                                    <HBox spacing="10" alignment="CENTER_LEFT">
                                        <Label text="Row Height:" style="-fx-font-size: 10;" />
                                        <Slider fx:id="ordersRowHeightSlider" min="24" max="150" value="72" blockIncrement="6" showTickLabels="false" showTickMarks="true" majorTickUnit="24" minorTickCount="5" prefWidth="150" />
                                        <Label fx:id="ordersRowHeightLabel" text="72 px" style="-fx-font-size: 10; -fx-min-width: 50;" />
                                    </HBox>
                                    
                                    <Separator />
                                    
                                    <!-- Column Visibility Controls -->
                                    <Label text="Column Visibility" style="-fx-font-weight:bold;" />
                                    <HBox spacing="10" alignment="CENTER_LEFT">
                                        <CheckBox fx:id="expandAllColumnsCheckbox" text="Expand All Columns">
                                            <tooltip>
                                                <Tooltip text="When unchecked, columns with no data will be automatically hidden. Check to show all columns regardless of data." />
                                            </tooltip>
                                        </CheckBox>
                                    </HBox>
                                    
                                    <Separator />

                                    <!-- Other Settings -->
                                    <Button fx:id="resetPathsButton" text="üîÑ Reset File Paths" styleClass="button-secondary" />
                                </VBox>
                            </ScrollPane>
                        </VBox>
                    </top>
                    
                    <!-- Main Content View with Data Tables -->
                    <center>
                        <HBox>
                            <!-- Main Content Area -->
                            <VBox HBox.hgrow="ALWAYS">
                                <SplitPane orientation="VERTICAL" dividerPositions="0.65" VBox.vgrow="ALWAYS">
                                    <items>
                                        <!-- Content Stack - Show/Hide based on navigation selection -->
                                        <StackPane fx:id="contentStack">
                                    <!-- Units View -->
                                    <BorderPane fx:id="unitsView" visible="true">
                                        <top>
                                            <HBox spacing="10" alignment="CENTER_LEFT" BorderPane.alignment="CENTER">
                                                <padding>
                                                    <Insets top="5" right="5" bottom="5" left="5" />
                                                </padding>
                                                <Label text="Filter by Config Group:" />
                                                <ComboBox fx:id="unitConfigGroupFilter" prefWidth="200" />
                                            </HBox>
                                        </top>
                                        <center>
                                            <TableView fx:id="tableUnits" editable="true">
                                                <columns>
                                                    <TableColumn fx:id="unitFacilityCol" prefWidth="120.0" text="Facility" />
                                                    <TableColumn fx:id="unitNamesCol" prefWidth="160.0" text="Unit Names" />
                                                    <TableColumn fx:id="unitPodRoomFilterCol" prefWidth="180.0" text="Filter for POD Rooms (Optional)" />
                                                    <TableColumn fx:id="unitNurseGroupCol" prefWidth="160.0" text="Nurse Group" />
                                                    <TableColumn fx:id="unitClinicalGroupCol" prefWidth="160.0" text="Clinical Group" />
                                                    <TableColumn fx:id="unitOrdersGroupCol" prefWidth="160.0" text="Orders Group" />
                                                    <TableColumn fx:id="unitNoCareGroupCol" prefWidth="180.0" text="No Caregiver Group" />
                                                    <TableColumn fx:id="unitCommentsCol" prefWidth="220.0" text="Comments" />
                                                </columns>
                                            </TableView>
                                        </center>
                                    </BorderPane>
                                    
                                    <!-- Nurse Calls View -->
                                    <BorderPane fx:id="nurseCallsView" visible="false">
                                        <top>
                                            <HBox spacing="10" alignment="CENTER_LEFT">
                                                <padding>
                                                    <Insets top="5" right="5" bottom="5" left="5" />
                                                </padding>
                                                <Label text="Filter by Config Group:" />
                                                <ComboBox fx:id="nurseConfigGroupFilter" prefWidth="200" />
                                                <Label text="Search:" />
                                                <TextField fx:id="nurseAlarmNameFilter" promptText="Search all columns..." prefWidth="200" />
                                            </HBox>
                                        </top>
                                        <center>
                                            <HBox spacing="0">
                                                <!-- Frozen In Scope Column -->
                                                <TableView fx:id="frozenNurseTable" editable="true" prefWidth="102" minWidth="102" maxWidth="102" styleClass="frozen-table">
                                                    <columns>
                                                        <TableColumn fx:id="frozenNurseInScopeCol" prefWidth="100.0" text="In Scope" />
                                                    </columns>
                                                </TableView>
                                                <!-- Main Scrollable Table -->
                                                <TableView fx:id="tableNurseCalls" editable="true" HBox.hgrow="ALWAYS">
                                                    <columns>
                                                        <TableColumn fx:id="nurseConfigGroupCol" prefWidth="160.0" text="Config Group" />
                                                        <TableColumn fx:id="nurseAlarmNameCol" prefWidth="200.0" text="Alarm Name" />
                                                        <TableColumn fx:id="nurseSendingNameCol" prefWidth="200.0" text="Sending Name" />
                                                        <TableColumn fx:id="nursePriorityCol" prefWidth="120.0" text="Priority" />
                                                        <TableColumn fx:id="nurseDeviceACol" prefWidth="140.0" text="Device A" />
                                                        <TableColumn fx:id="nurseDeviceBCol" prefWidth="140.0" text="Device B" />
                                                        <TableColumn fx:id="nurseRingtoneCol" prefWidth="160.0" text="Ringtone" />
                                                        <TableColumn fx:id="nurseResponseOptionsCol" prefWidth="160.0" text="Response Options" />
                                                        <TableColumn fx:id="nurseBreakThroughDNDCol" prefWidth="160.0" text="Break Through DND" />
                                                        <TableColumn fx:id="nurseEscalateAfterCol" prefWidth="160.0" text="Escalate After" />
                                                        <TableColumn fx:id="nurseTtlValueCol" prefWidth="140.0" text="Time to Live (TTL)" />
                                                        <TableColumn fx:id="nurseEnunciateCol" prefWidth="140.0" text="Genie Enunciation" />
                                                        <TableColumn fx:id="nurseT1Col" prefWidth="140.0" text="Time to 1st" />
                                                        <TableColumn fx:id="nurseR1Col" prefWidth="220.0" text="1st Recipient" />
                                                        <TableColumn fx:id="nurseT2Col" prefWidth="140.0" text="Time to 2nd" />
                                                        <TableColumn fx:id="nurseR2Col" prefWidth="220.0" text="2nd Recipient" />
                                                        <TableColumn fx:id="nurseT3Col" prefWidth="140.0" text="Time to 3rd" />
                                                        <TableColumn fx:id="nurseR3Col" prefWidth="220.0" text="3rd Recipient" />
                                                        <TableColumn fx:id="nurseT4Col" prefWidth="140.0" text="Time to 4th" />
                                                        <TableColumn fx:id="nurseR4Col" prefWidth="220.0" text="4th Recipient" />
                                                        <TableColumn fx:id="nurseT5Col" prefWidth="140.0" text="Time to 5th" />
                                                        <TableColumn fx:id="nurseR5Col" prefWidth="220.0" text="5th Recipient" />
                                                    </columns>
                                                </TableView>
                                            </HBox>
                                        </center>
                                    </BorderPane>
                                    
                                    <!-- Clinicals View -->
                                    <BorderPane fx:id="clinicalsView" visible="false">
                                        <top>
                                            <HBox spacing="10" alignment="CENTER_LEFT">
                                                <padding>
                                                    <Insets top="5" right="5" bottom="5" left="5" />
                                                </padding>
                                                <Label text="Filter by Config Group:" />
                                                <ComboBox fx:id="clinicalConfigGroupFilter" prefWidth="200" />
                                                <Label text="Search:" />
                                                <TextField fx:id="clinicalAlarmNameFilter" promptText="Search all columns..." prefWidth="200" />
                                            </HBox>
                                        </top>
                                        <center>
                                            <HBox spacing="0">
                                                <!-- Frozen In Scope Column -->
                                                <TableView fx:id="frozenClinicalTable" editable="true" prefWidth="102" minWidth="102" maxWidth="102" styleClass="frozen-table">
                                                    <columns>
                                                        <TableColumn fx:id="frozenClinicalInScopeCol" prefWidth="100.0" text="In Scope" />
                                                    </columns>
                                                </TableView>
                                                <!-- Main Scrollable Table -->
                                                <TableView fx:id="tableClinicals" editable="true" HBox.hgrow="ALWAYS">
                                                    <columns>
                                                        <TableColumn fx:id="clinicalConfigGroupCol" prefWidth="160.0" text="Config Group" />
                                                        <TableColumn fx:id="clinicalAlarmNameCol" prefWidth="200.0" text="Alarm Name" />
                                                        <TableColumn fx:id="clinicalSendingNameCol" prefWidth="200.0" text="Sending Name" />
                                                        <TableColumn fx:id="clinicalPriorityCol" prefWidth="120.0" text="Priority" />
                                                        <TableColumn fx:id="clinicalDeviceACol" prefWidth="140.0" text="Device A" />
                                                        <TableColumn fx:id="clinicalDeviceBCol" prefWidth="140.0" text="Device B" />
                                                        <TableColumn fx:id="clinicalRingtoneCol" prefWidth="160.0" text="Ringtone" />
                                                        <TableColumn fx:id="clinicalResponseOptionsCol" prefWidth="160.0" text="Response Options" />
                                                        <TableColumn fx:id="clinicalBreakThroughDNDCol" prefWidth="160.0" text="Break Through DND" />
                                                        <TableColumn fx:id="clinicalEscalateAfterCol" prefWidth="160.0" text="Escalate After" />
                                                        <TableColumn fx:id="clinicalTtlValueCol" prefWidth="140.0" text="Time to Live (TTL)" />
                                                        <TableColumn fx:id="clinicalEnunciateCol" prefWidth="140.0" text="Genie Enunciation" />
                                                        <TableColumn fx:id="clinicalEmdanCol" prefWidth="140.0" text="EMDAN Compliant" />
                                                        <TableColumn fx:id="clinicalT1Col" prefWidth="140.0" text="Time to 1st" />
                                                        <TableColumn fx:id="clinicalR1Col" prefWidth="220.0" text="1st Recipient" />
                                                        <TableColumn fx:id="clinicalT2Col" prefWidth="140.0" text="Time to 2nd" />
                                                        <TableColumn fx:id="clinicalR2Col" prefWidth="220.0" text="2nd Recipient" />
                                                        <TableColumn fx:id="clinicalT3Col" prefWidth="140.0" text="Time to 3rd" />
                                                        <TableColumn fx:id="clinicalR3Col" prefWidth="220.0" text="3rd Recipient" />
                                                        <TableColumn fx:id="clinicalT4Col" prefWidth="140.0" text="Time to 4th" />
                                                        <TableColumn fx:id="clinicalR4Col" prefWidth="220.0" text="4th Recipient" />
                                                        <TableColumn fx:id="clinicalT5Col" prefWidth="140.0" text="Time to 5th" />
                                                        <TableColumn fx:id="clinicalR5Col" prefWidth="220.0" text="5th Recipient" />
                                                    </columns>
                                                </TableView>
                                            </HBox>
                                        </center>
                                    </BorderPane>
                                    
                                    <!-- Orders View -->
                                    <BorderPane fx:id="ordersView" visible="false">
                                        <top>
                                            <HBox spacing="10" alignment="CENTER_LEFT">
                                                <padding>
                                                    <Insets top="5" right="5" bottom="5" left="5" />
                                                </padding>
                                                <Label text="Filter by Config Group:" />
                                                <ComboBox fx:id="ordersConfigGroupFilter" prefWidth="200" />
                                                <Label text="Search:" />
                                                <TextField fx:id="ordersAlarmNameFilter" promptText="Search all columns..." prefWidth="200" />
                                            </HBox>
                                        </top>
                                        <center>
                                            <HBox spacing="0">
                                                <!-- Frozen In Scope column -->
                                                <TableView fx:id="frozenOrdersTable" editable="true" prefWidth="102" minWidth="102" maxWidth="102" styleClass="frozen-table">
                                                    <columns>
                                                        <TableColumn fx:id="frozenOrdersInScopeCol" prefWidth="100.0" text="In Scope" />
                                                    </columns>
                                                </TableView>
                                                <!-- Main scrollable table -->
                                                <TableView fx:id="tableOrders" editable="true" HBox.hgrow="ALWAYS">
                                                    <columns>
                                                        <TableColumn fx:id="ordersConfigGroupCol" prefWidth="160.0" text="Config Group" />
                                                        <TableColumn fx:id="ordersAlarmNameCol" prefWidth="200.0" text="Alarm Name" />
                                                        <TableColumn fx:id="ordersSendingNameCol" prefWidth="200.0" text="Sending Name" />
                                                        <TableColumn fx:id="ordersPriorityCol" prefWidth="120.0" text="Priority" />
                                                        <TableColumn fx:id="ordersDeviceACol" prefWidth="140.0" text="Device A" />
                                                        <TableColumn fx:id="ordersDeviceBCol" prefWidth="140.0" text="Device B" />
                                                        <TableColumn fx:id="ordersRingtoneCol" prefWidth="160.0" text="Ringtone" />
                                                        <TableColumn fx:id="ordersResponseOptionsCol" prefWidth="160.0" text="Response Options" />
                                                        <TableColumn fx:id="ordersBreakThroughDNDCol" prefWidth="160.0" text="Break Through DND" />
                                                        <TableColumn fx:id="ordersEscalateAfterCol" prefWidth="160.0" text="Escalate After" />
                                                        <TableColumn fx:id="ordersTtlValueCol" prefWidth="140.0" text="Time to Live (TTL)" />
                                                        <TableColumn fx:id="ordersEnunciateCol" prefWidth="140.0" text="Genie Enunciation" />
                                                        <TableColumn fx:id="ordersT1Col" prefWidth="140.0" text="Time to 1st" />
                                                        <TableColumn fx:id="ordersR1Col" prefWidth="220.0" text="1st Recipient" />
                                                        <TableColumn fx:id="ordersT2Col" prefWidth="140.0" text="Time to 2nd" />
                                                        <TableColumn fx:id="ordersR2Col" prefWidth="220.0" text="2nd Recipient" />
                                                        <TableColumn fx:id="ordersT3Col" prefWidth="140.0" text="Time to 3rd" />
                                                        <TableColumn fx:id="ordersR3Col" prefWidth="220.0" text="3rd Recipient" />
                                                        <TableColumn fx:id="ordersT4Col" prefWidth="140.0" text="Time to 4th" />
                                                        <TableColumn fx:id="ordersR4Col" prefWidth="220.0" text="4th Recipient" />
                                                        <TableColumn fx:id="ordersT5Col" prefWidth="140.0" text="Time to 5th" />
                                                        <TableColumn fx:id="ordersR5Col" prefWidth="220.0" text="5th Recipient" />
                                                    </columns>
                                                </TableView>
                                            </HBox>
                                        </center>
                                    </BorderPane>
                                </StackPane>

                                <!-- JSON Preview -->
                                <VBox spacing="5">
                                    <Label text="üìã JSON Preview" style="-fx-font-weight: bold; -fx-font-size: 14px;" />
                                    <TextArea fx:id="jsonPreview" wrapText="true" prefRowCount="10" />
                                </VBox>
                            </items>
                        </SplitPane>
                            </VBox>
                            
                            <!-- Right Tool Panel (Design C: Split Panel) -->
                            <VBox fx:id="toolPanel" prefWidth="220" minWidth="200" styleClass="tool-panel">
                                <padding>
                                    <Insets top="15" right="15" bottom="15" left="15" />
                                </padding>
                                
                                <!-- Tool Panel Title -->
                                <Label text="‚öôÔ∏è Quick Settings" styleClass="tool-panel-title" />
                                
                                <Separator style="-fx-padding: 8 0;" />
                                
                                <!-- Merge Options Section -->
                                <VBox spacing="6" styleClass="tool-panel-section">
                                    <Label text="Merge Options" styleClass="tool-panel-label" />
                                    <CheckBox fx:id="toolPanelNoMergeCheckbox" text="Standard (No Merge)">
                                        <tooltip>
                                            <Tooltip text="Standard Mode: Each alarm/alert gets its own separate delivery flow." />
                                        </tooltip>
                                    </CheckBox>
                                    <CheckBox fx:id="toolPanelMergeMultiCheckbox" text="Merge Multiple Groups">
                                        <tooltip>
                                            <Tooltip text="Merge Multiple Config Groups: Combines flows across MULTIPLE Config Groups." />
                                        </tooltip>
                                    </CheckBox>
                                    <CheckBox fx:id="toolPanelMergeSingleCheckbox" text="Merge Single Group" selected="true">
                                        <tooltip>
                                            <Tooltip text="Merge by Single Config Group: Combines flows ONLY within the same Config Group." />
                                        </tooltip>
                                    </CheckBox>
                                </VBox>
                                
                                <Separator style="-fx-padding: 8 0;" />
                                
                                <!-- Data Validation Section -->
                                <VBox spacing="6" styleClass="tool-panel-section">
                                    <Label text="Data Validation" styleClass="tool-panel-label" />
                                    <Button fx:id="toolPanelLoadVoiceGroupBtn" text="Load Voice Groups" maxWidth="Infinity" styleClass="tool-panel-btn">
                                        <tooltip>
                                            <Tooltip text="Load valid voice groups from Excel/CSV" />
                                        </tooltip>
                                    </Button>
                                    <Button fx:id="toolPanelLoadBedListBtn" text="Load Bed List" maxWidth="Infinity" styleClass="tool-panel-btn">
                                        <tooltip>
                                            <Tooltip text="Load valid bed list from Excel/CSV" />
                                        </tooltip>
                                    </Button>
                                </VBox>
                                
                                <Separator style="-fx-padding: 8 0;" />
                                
                                <!-- Adapter References Section -->
                                <VBox spacing="6" styleClass="tool-panel-section">
                                    <Label text="Adapter References" styleClass="tool-panel-label" />
                                    <HBox spacing="6" alignment="CENTER_LEFT">
                                        <Label text="Edge:" prefWidth="45" />
                                        <TextField fx:id="toolPanelEdgeRefField" promptText="OutgoingWCTP" prefWidth="130" styleClass="tool-panel-input">
                                            <tooltip>
                                                <Tooltip text="Edge interface reference name" />
                                            </tooltip>
                                        </TextField>
                                    </HBox>
                                    <HBox spacing="6" alignment="CENTER_LEFT">
                                        <Label text="VMP:" prefWidth="45" />
                                        <TextField fx:id="toolPanelVmpRefField" promptText="VMP" prefWidth="130" styleClass="tool-panel-input">
                                            <tooltip>
                                                <Tooltip text="VMP interface reference name" />
                                            </tooltip>
                                        </TextField>
                                    </HBox>
                                </VBox>
                                
                                <Region VBox.vgrow="ALWAYS" />
                                
                                <!-- Panel Toggle Button -->
                                <Button fx:id="toolPanelToggleBtn" text="‚óÄ Hide Panel" maxWidth="Infinity" styleClass="tool-panel-toggle">
                                    <tooltip>
                                        <Tooltip text="Hide/Show the Quick Settings panel" />
                                    </tooltip>
                                </Button>
                            </VBox>
                        </HBox>
                    </center>
                </BorderPane>
            </center>
        </BorderPane>
    </center>

    <padding>
        <Insets top="0" right="0" bottom="0" left="0" />
    </padding>
</BorderPane>
